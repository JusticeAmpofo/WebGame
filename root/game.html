<!doctype html>
<html>

  <head>
      <meta charset="utf-8">
      <title>Game - Justice Ampofo</title>
      <link rel="stylesheet" href="css/style.css">
  </head>

  <body>

    <canvas id="myCanvas"></canvas>

    <script>
      // Get reference to canvas
      var canvas = document.getElementById('myCanvas');
      var context = canvas.getContext('2d');

      // Size canvas to fill screen
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;

      //player
      var player = {
        // Keep track of player's position
        posX: canvas.width / 2,
        posY: canvas.height / 2,
        rad:50, //player's radius
        faceCol: 'blue'
      };

      //goal
      var goal = {
        posX: Math.round(Math.random()*canvas.width),
        posY:  Math.round(Math.random()*canvas.height),
        rad:70,
        lineThick:5
      };



      function setRandom()
      {
         goal.posX = Math.round(Math.random()*canvas.width);
         goal.posY = Math.round(Math.random()*canvas.height);
      }

      function drawStationPlayer(x,y)
      {
        context.beginPath();
        context.fillStyle = 'blue';
        context.beginPath();
        context.arc(x, y, 80, 0, Math.PI*2);
        context.fill();

        //Draw player's left eye
        context.beginPath();
        context.arc(x-25, y-30, 20, 0, Math.PI * 2);
        context.fillStyle = 'white';
        context.fill();

        //Draw player's right eye
        context.beginPath();
        context.arc(x+25, y-30, 20, 0, Math.PI * 2);
        context.fillStyle = 'white';
        context.fill();

        //Draw player's mouth
        context.beginPath();
        context.arc(x, y+15, 40, 0, Math.PI);
        context.fillStyle = 'white';
        context.fill();
      }

      var score = 0;
      var counter = 10;
      var timer;

      timer = setInterval(function() {

          if(counter  < 0)
          {
            gameOver();
          }
          else
          {
            counter--;
          }
      }, 1000);


			// Listen for device orientation event
      function startGame()
      {
  			window.ondeviceorientation = function(eventData)
  			{
  				// Move the player
  				player.posX = player.posX + event.gamma;
  				player.posY = player.posY + event.beta;

          //the Distance between player and goal
          var dx =  (goal.posX) - (player.posX);
          var dy =  (goal.posY) - (player.posY);
          var distance = Math.sqrt((dx * dx) + (dy * dy));

  				// Keep Player in bounds
  				if (player.posX < 0) player.posX = 0;
  				if (player.posX > canvas.width) player.posX = canvas.width;
  				if (player.posY < 0) player.posY = 0;
  				if (player.posY > canvas.height) player.posY = canvas.height;

          //collision
          if (distance < player.rad + goal.rad)
          {
            player.faceCol = 'green';
            score ++;
            setRandom();
          }
          else
          {
          }



  				// Clear scene
  				context.clearRect(0, 0, canvas.width, canvas.height);

          //Draw goal
          context.beginPath();
          context.arc(goal.posX, goal.posY, goal.rad, 0, Math.PI*2);
          context.fillStyle = 'yellow';
          context.lineWidth = goal.lineThick;
          context.fill();

  				// Draw player
  				context.beginPath();
  				context.arc(player.posX, player.posY, player.rad, 0, Math.PI * 2);
  				context.fillStyle = player.faceCol;
  				context.fill();

          //Draw player's left eye
          context.beginPath();
  				context.arc(player.posX-15, player.posY-15, 10, 0, Math.PI * 2);
  				context.fillStyle = 'white';
  				context.fill();

          //Draw player's right eye
          context.beginPath();
  				context.arc(player.posX+15, player.posY-15, 10, 0, Math.PI * 2);
  				context.fillStyle = 'white';
  				context.fill();

          //Draw player's mouth
          context.beginPath();
  				context.arc(player.posX, player.posY+10, 20, 0, Math.PI);
  				context.fillStyle = 'white';
  				context.fill();

          //font
          context.font = '20px Verdana';
          // Horizontal text alignment
          context.textAlign = 'center';

          // Vertical text alignment, default is "alphabetic"
          context.textBaseline = 'middle';
          context.fillStyle = 'white';
          context.fillText('Score: ' + score, 50, 25);
          context.fillText('Time: ' + counter, 150, 25);
  			}
    } //startGame ends

    function gameOver()
    {
        window.ondeviceorientation = null;
        clearInterval(timer);
        context.clearRect(0, 0, canvas.width, canvas.height);
        alert('hi');
        context.beginPath();
        context.font = '40px Verdana';
        context.fillStyle = 'white';
        context.fillText('Score: ' + score, canvas.width/2 , canvas.height/2);
        context.fill();

        drawStationPlayer((canvas.width/2), ((canvas.height/2) - 100) );

    }

    startGame();
    </script>

  </body>
</html>
